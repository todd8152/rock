version: "2"
services:
  logstash:
    image: "docker.elastic.co/logstash/logstash:{{ elastic_ver }}"
    container_name: "{{ logstash_container_name }}"
    restart: always
    #ports:
    #- 5044:5044
    volumes:
    - "{{ logstash_pipeline_dir }}:/usr/share/logstash/pipeline/"
    - "{{ logstash_data_dir }}:/usr/share/logstash/data/"
    - "{{ logstash_log_dir }}:{{ logstash_log_dir }}"
    - "{{ logstash_config_dir}}/pipelines.yml:/usr/share/logstash/config/pipelines.yml"
    environment:
    # force logstash to read pipelines.yml
    - "path.config=null"
    - "node.name={{ logstash_container_name }}.{{ inventory_hostname_short }}"
    #- "ES_JAVA_OPTS=-Xms1G -Xmx1G -XX:-AssumeMP"
    - "xpack.monitoring.enabled={{ xpack_license }}"
    - "xpack.management.enabled={{ xpack_license }}"

networks:
  default:
    external:
      name: 'rocknsm_inside'

